require.modules["[%= fileName %]"] = function (rootRequire) {

    var __dirname       = "[%= dirName %]"
    var __filename      = "[%= fileName %]"
    
    var exports         = {}
    var module          = { exports : exports }
    
    var require         = rootRequire.child(__dirname)
    
    require.cache[ __filename ] = exports; 
    
    [%\ if (includeJooseCompat) { %]
    
    var Joose           = require('joose')
    var Class           = function (name, config) { return module.exports   = Joose.Class(config) }
    var Role            = function (name, config) { return module.exports   = Joose.Role(config) }
    var Module          = function (name, config) { return module.exports   = Joose.Module(config) }
        
    [%\ } %]
    
    ;(function () {
        [%\ if (/\.json$/.test(fileName)) { %]
            module.exports = [%= content %] 
        [%\ } else { %]
            
            [%= content %]
            
        [%\ } %]
    }).call(module.exports)
    
    return module.exports
}

